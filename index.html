<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ghost Writer</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffffff">

    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%235f6ad4' d='M256 48C141.1 48 48 141.1 48 256v160c0 17.7 14.3 32 32 32h32c17.7 0 32-14.3 32-32v-32h224v32c0 17.7 14.3 32 32 32h32c17.7 0 32-14.3 32-32V256C464 141.1 370.9 48 256 48zM176 256c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm160 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z'/%3E%3C/svg%3E">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cutive+Mono&family=Fredoka:wght@400;500;600&family=Lora:ital,wght@0,400;0,600;1,400&family=Nunito:wght@300;400;700&family=Patrick+Hand&family=Quicksand:wght@500;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <link rel="stylesheet" href="style.css">

</head>

<body>
    <div class="app-container">
        <div id="page-loader" class="page-loader"></div>

        <div id="custom-modal" class="modal-overlay hidden">
            <div class="modal-box">
                <h3 id="modal-title">Confirm Action</h3>
                <p id="modal-msg">Are you sure you want to do this?</p>
                <div class="modal-actions">
                    <button id="modal-cancel" class="btn-bordered-custom">Cancel</button>
                    <button id="modal-confirm" class="btn-delete">Yes, Delete</button>
                </div>
            </div>
        </div>

        <div id="template-modal" class="modal-overlay hidden" style="z-index: 3600;">
            <div class="modal-box template-modal-box">
                <div class="template-header">
                    <h3>Choose a Template</h3>
                    <button id="btn-close-template" class="btn-bordered-custom">
                        <i class="fa-solid fa-times"></i>
                    </button>
                </div>

                <div class="template-categories">
                    <button class="category-btn active" data-category="all">All Templates</button>
                    <button class="category-btn" data-category="work">Work & Business</button>
                    <button class="category-btn" data-category="study">Study & Learning</button>
                    <button class="category-btn" data-category="personal">Personal & Journal</button>
                    <button class="category-btn" data-category="creative">Creative Writing</button>
                </div>

                <div id="template-grid" class="template-grid">
                </div>
            </div>
        </div>

        <div id="auth-modal" class="modal-overlay hidden" style="z-index: 4000;">
            <div class="modal-box auth-box">
                <div class="auth-nav">
                    <button class="auth-nav-btn active" data-mode="login">Login</button>
                    <button class="auth-nav-btn" data-mode="signup">Signup</button>
                </div>

                <div class="auth-form-viewport">
                    <div id="login-form" class="auth-form active-form">
                        <input type="email" id="login-email" class="auth-input" placeholder="Email Address"
                            autocomplete="email">
                        <input type="password" id="login-password" class="auth-input" placeholder="Password"
                            autocomplete="current-password">
                        <div id="login-error" class="error-text hidden"></div>
                    </div>

                    <div id="signup-form" class="auth-form">
                        <input type="text" id="signup-username" class="auth-input" placeholder="Username"
                            autocomplete="username">
                        <input type="email" id="signup-email" class="auth-input" placeholder="Email Address"
                            autocomplete="email">
                        <input type="password" id="signup-password" class="auth-input" placeholder="Password"
                            autocomplete="new-password">
                        <div id="signup-error" class="error-text hidden"></div>
                    </div>
                </div>

                <div class="auth-modal-actions">
                    <button id="auth-cancel" class="btn-bordered-custom">Cancel</button>
                    <button id="auth-proceed" class="btn btn-primary">Proceed</button>
                </div>
            </div>
        </div>

        <div id="guest-modal" class="modal-overlay hidden" style="z-index: 4100;">
            <div class="modal-box guest-box">
                <h3>Enter Guest Username</h3>
                <p>This will be used to backup your local data if you create an account later.</p>
                <input type="text" id="guest-username" class="auth-input" placeholder="Choose a username">
                <div id="guest-error" class="error-text hidden"></div>
                <div class="guest-modal-actions">
                    <button id="guest-cancel" class="btn-bordered-custom semi-square">Cancel</button>
                    <button id="guest-proceed" class="btn btn-primary semi-square">Start as Guest</button>
                </div>
            </div>
        </div>

        <div id="export-modal" class="modal-overlay hidden" style="z-index: 3500;">
            <div class="modal-box export-box">
                <i class="fa-solid fa-file-pdf export-icon"></i>
                <h3>Export PDF</h3>
                <p>Customize your download.</p>

                <div class="export-form">
                    <label>File Name</label>
                    <input type="text" id="export-filename" class="login-input" placeholder="GhostNotes"
                        value="GhostNotes">

                    <label>PDF Theme</label>
                    <div class="theme-selector-row">
                        <button class="theme-option active" data-theme="light">
                            <i class="fa-solid fa-sun"></i> Light (Print)
                        </button>
                        <button class="theme-option" data-theme="dark">
                            <i class="fa-solid fa-moon"></i> Dark (Screen)
                        </button>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="btn-cancel-export" class="btn-bordered-custom">Cancel</button>
                    <button id="btn-confirm-export" class="btn btn-primary">Download</button>
                </div>
            </div>
        </div>

        <section id="view-intro" class="view-section active">
            <header class="app-header simple-header">
                <div class="logo">Ghost Writer</div>
                <div class="header-right">
                    <div class="theme-guest-container">
                        <button id="theme-toggle-intro" class="text-toggle-btn theme-btn-ref">
                            <span class="theme-text-span">Day</span>
                        </button>
                        <button id="guest-btn-intro" class="text-toggle-btn guest-btn ">
                            <span class="guest-text">Guest</span>
                        </button>
                    </div>
                </div>
            </header>

            <div class="hero-content center-content">
                <div class="text-section text-center">
                    <span class="badge">Distraction Free</span>
                    <h1>Clear Mind.</h1>
                    <p class="subtitle">Just you and your thoughts. No clutter, just focus.</p>

                    <div class="btn-group center-buttons">
                        <button id="btn-lets-go" class="btn btn-primary">Start Writing</button>
                    </div>
                </div>

                <div class="visual-section">
                    <div class="circle-bg">
                        <i class="fa-solid fa-ghost big-ghost"></i>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-dashboard" class="view-section hidden">
            <header class="app-header dashboard-mobile-layout">
                <div class="logo logo-sm" id="user-greeting">Welcome Back</div>
                <div id="dash-btn-container" class="header-right dash-buttons-row">
                    <button id="btn-dashboard-back" class="text-toggle-btn icon-switch-btn" title="Home">
                        <span class="desktop-text">Home</span>
                        <i class="mobile-icon fa-solid fa-house"></i>
                    </button>

                    <button id="theme-toggle-dash" class="text-toggle-btn theme-btn-ref icon-switch-btn" title="Theme">
                        <span class="theme-text-span desktop-text">Day</span>
                        <i class="mobile-icon fa-solid fa-circle-half-stroke"></i>
                    </button>

                    <button id="btn-dashboard-history" class="text-toggle-btn icon-switch-btn" title="History">
                        <span class="desktop-text">History</span>
                        <i class="mobile-icon fa-solid fa-clock-rotate-left"></i>
                    </button>

                    <button id="btn-dashboard-bin" class="text-toggle-btn icon-switch-btn desktop-only-bin"
                        title="Recycle Bin">
                        <span class="desktop-text">Bin</span>
                        <i class="mobile-icon fa-solid fa-trash-can"></i>
                    </button>

                    <button id="btn-logout" class="text-toggle-btn icon-switch-btn logout-btn-style hidden"
                        title="Logout">
                        <span class="desktop-text">Logout</span>
                        <i class="mobile-icon fa-solid fa-right-from-bracket"></i>
                    </button>
                </div>
            </header>

            <div class="dashboard-content">
                <p class="dash-subtitle">Pick up where you left off or start fresh.</p>
                <div id="dashboard-cards" class="dash-grid"></div>

                <div class="mobile-dash-actions mobile-only-section">
                    <div id="btn-new-note-mob" class="mobile-action-card primary">
                        <i class="fa-solid fa-plus"></i>
                        <span>New Note</span>
                    </div>
                    <div id="btn-open-bin-mob" class="mobile-action-card">
                        <i class="fa-solid fa-trash-can"></i>
                        <span>Bin</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-home" class="view-section hidden">
            <header class="writer-header-new">
                <div class="wh-left">
                    <button id="btn-exit" class="btn-bordered-custom icon-switch-btn">
                        <span class="desktop-text">Back</span>
                        <i class="mobile-icon fa-solid fa-arrow-left"></i>
                    </button>
                </div>
                <div class="wh-center">
                    <input type="text" id="note-title" placeholder="Untitled Topic..." autocomplete="off">
                </div>
                <div class="wh-right">
                    <button id="btn-open-templates" class="text-toggle-btn template-btn-desktop icon-switch-btn"
                        title="Templates">
                        <span class="desktop-text">Templates</span>
                        <i class="mobile-icon fa-solid fa-layer-group"></i>
                    </button>

                    <button id="theme-toggle-writer" class="text-toggle-btn theme-btn-ref icon-switch-btn"
                        title="Toggle Theme">
                        <span class="theme-text-span desktop-text">Day</span>
                        <i class="mobile-icon fa-solid fa-circle-half-stroke"></i>
                    </button>
                </div>
            </header>

            <div class="writer-box">
                <div class="meta-strip">
                    <span id="current-date" class="meta-date">Date</span>
                    <span class="meta-separator">â€¢</span>
                    <span id="word-count" class="word-badge">0 words</span>
                </div>

                <div class="writer-toolbar-container">
                    <div id="toolbar-belt" class="toolbar-belt" style="scrollbar-width: none;">
                        <button class="tool-btn color-btn" data-color="#000000" title="Black"
                            style="background-color: #000000;"></button>
                        <button class="tool-btn color-btn" data-color="#ffffff" title="White"
                            style="background-color: #ffffff;"></button>
                        <button class="tool-btn color-btn" data-color="#2563eb" title="Blue"
                            style="background-color: #2563eb;"></button>
                        <button class="tool-btn color-btn" data-color="#dc2626" title="Red"
                            style="background-color: #dc2626;"></button>
                        <button class="tool-btn color-btn" data-color="#16a34a" title="Green"
                            style="background-color: #16a34a;"></button>
                        <button class="tool-btn color-btn" data-color="#ea580c" title="Orange"
                            style="background-color: #ea580c;"></button>

                        <div class="divider-v"></div>

                        <button class="tool-btn format-btn" data-cmd="insertUnorderedList" title="Bullets"><i
                                class="fa-solid fa-list-ul"></i></button>
                        <button class="tool-btn format-btn" data-cmd="insertOrderedList" title="Numbers"><i
                                class="fa-solid fa-list-ol"></i></button>
                        <button class="tool-btn format-btn" data-cmd="bold" title="Bold"><i
                                class="fa-solid fa-bold"></i></button>
                        <button class="tool-btn format-btn" data-cmd="italic" title="Italic"><i
                                class="fa-solid fa-italic"></i></button>
                        <button class="tool-btn format-btn" data-cmd="underline" title="Underline"><i
                                class="fa-solid fa-underline"></i></button>

                        <div class="divider-v"></div>

                        <button class="tool-btn text-pill" style="background-color: #e3f2fd; color: #1565c0;"
                            data-text="TODO: ">TODO</button>
                        <button class="tool-btn text-pill" style="background-color: #fff8e1; color: #f57f17;"
                            data-text="WIP: ">WIP</button>
                        <button class="tool-btn text-pill" style="background-color: #e8f5e9; color: #2e7d32;"
                            data-text="DONE: ">DONE</button>
                        <button class="tool-btn text-pill" style="background-color: #f5f5f5; color: #616161;"
                            data-text="HOLD: ">HOLD</button>

                        <button class="tool-btn text-pill" style="background-color: #ffebee; color: #c62828;"
                            data-text="URGENT: ">URGENT</button>
                        <button class="tool-btn text-pill" style="background-color: #fbe9e7; color: #d84315;"
                            data-text="IMP: ">IMP</button>

                        <button class="tool-btn text-pill" style="background-color: #f3e5f5; color: #6a1b9a;"
                            data-text="IDEA: ">IDEA</button>
                        <button class="tool-btn text-pill" style="background-color: #e1f5fe; color: #0277bd;"
                            data-text="NOTE: ">NOTE</button>
                        <button class="tool-btn text-pill" style="background-color: #e0f2f1; color: #00695c;"
                            data-text="Que: ">Que</button>
                        <button class="tool-btn text-pill" style="background-color: #e8eaf6; color: #283593;"
                            data-text="Ans: ">Ans</button>

                        <button class="tool-btn text-pill" style="background-color: #fff3e0; color: #ef6c00;"
                            data-text="FIX: ">FIX</button>
                        <button class="tool-btn text-pill" style="background-color: #eceff1; color: #37474f;"
                            data-text="DEBUG: ">DEBUG</button>
                        <button class="tool-btn text-pill" style="background-color: #efebe9; color: #4e342e;"
                            data-text="REVIEW: ">REVIEW</button>
                    </div>
                </div>

                <div id="writer-area" class="rich-editor" contenteditable="true" spellcheck="false"
                    data-placeholder="Just write..."></div>

                <div class="writer-footer">
                    <span id="save-status" class="status-text">Ready</span>
                </div>
            </div>
        </section>

        <section id="view-history" class="view-section hidden">
            <header class="history-header">
                <div class="header-left">
                    <button id="btn-back-to-dashboard" class="btn-bordered-custom icon-switch-btn">
                        <span class="desktop-text">Back</span>
                        <i class="mobile-icon fa-solid fa-chevron-left"></i>
                    </button>
                </div>
                <div class="header-center">
                    <h2>All Notes</h2>
                </div>
                <div class="header-right history-actions-container">
                    <button id="btn-select-mode" class="text-toggle-btn icon-switch-btn semi-square-mob">
                        <span class="btn-label-text">Select</span>
                    </button>

                    <div id="bulk-actions-wrapper" class="bulk-actions-wrapper hidden">
                        <button id="btn-export-selected"
                            class="btn-bordered-custom icon-switch-btn semi-square-mob full-btn-mob">
                            <span class="export-label-text">Export</span>
                            <i class="mobile-icon fa-solid fa-file-arrow-down hidden-on-text-mode"></i>
                        </button>

                        <button id="btn-delete-selected"
                            class="btn-delete icon-switch-btn semi-square-mob full-btn-mob">
                            <span class="delete-label-text">Delete (<span id="selected-count">0</span>)</span>
                            <i class="mobile-icon fa-solid fa-trash hidden-on-text-mode"></i>
                        </button>
                    </div>

                    <button id="theme-toggle-history"
                        class="text-toggle-btn theme-btn-ref icon-switch-btn mobile-hide-strict">
                        <span class="theme-text-span desktop-text">Day</span>
                        <i class="mobile-icon fa-solid fa-circle-half-stroke"></i>
                    </button>
                </div>
            </header>

            <div class="history-body">
                <div id="notes-grid" class="bento-grid"></div>
                <div id="empty-history-msg" class="hidden">No saved notes found.</div>
            </div>
        </section>

        <section id="view-bin" class="view-section hidden">
            <header class="history-header">
                <div class="header-left">
                    <button id="btn-back-from-bin" class="btn-bordered-custom icon-switch-btn">
                        <span class="desktop-text">Back</span>
                        <i class="mobile-icon fa-solid fa-chevron-left"></i>
                    </button>
                </div>
                <div class="header-center">
                    <h2>Recycle Bin</h2>
                </div>
                <div class="header-right history-actions-container">
                    <button id="btn-empty-bin" class="btn-delete icon-switch-btn semi-square-mob">
                        <span class="desktop-text">Clear All</span>
                        <i class="mobile-icon fa-solid fa-fire"></i>
                    </button>
                </div>
            </header>

            <div class="history-body">
                <div id="bin-grid" class="bento-grid"></div>
                <div id="empty-bin-msg" class="hidden"
                    style="text-align:center; margin-top:20px; color:var(--text-muted);">
                    Recycle bin is empty.
                </div>
            </div>
        </section>

        <div id="mobile-preview-overlay" class="preview-overlay hidden"></div>
        <div id="mobile-preview-sheet" class="preview-sheet">
            <div class="sheet-handle-bar"></div>
            <div class="sheet-header">
                <button id="sheet-close-btn" class="icon-btn-sheet"><i class="fa-solid fa-chevron-down"></i></button>
                <div class="sheet-meta">
                    <span id="sheet-date">Date</span>
                </div>
                <button id="sheet-edit-btn" class="icon-btn-sheet edit-action"><i
                        class="fa-solid fa-pencil"></i></button>
            </div>
            <div class="sheet-content">
                <h2 id="sheet-title">Note Title</h2>
                <div id="sheet-body"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>